import{f as e,M as a,l,m as s,j as t,k as u,P as n,Q as r,O as c,o as i,d as o,q as v,F as p,e as f,g as m,t as y,z as d,s as x}from"./vendor.e1762ece.js";import{L as g}from"./index.d.0906a426.js";import{u as b,a as h,_ as k,b as w}from"./index.299bc7d5.js";import{_}from"./cover.vue_vue_type_script_setup_true_lang.2dfc415e.js";const j={key:0,class:"h-full flex-col flex"},C={class:"bg-gray-800 shadow-lg py-4 px-2 w-full flex self-start items-center space-x-3"},I={alt:"头像",class:"h-12 w-12 rounded-full relative z-10"},U={class:"flex-1"},O={class:"flex-1 overflow-y-auto flex flex-wrap px-2 py-4 justify-center"},A={key:1,class:"text-center h-full flex flex-col space-y-3 justify-center px-2"};var N=e({setup(e){const N=b(),T=a(),z=l(!1),E=l(!0),M=l(!0),$=l([]),q=l(0),F=l(null),L=s((()=>N.state.userInfo)),P=s((()=>$.value.slice(0,1))),Q=s((()=>$.value.slice(1))),R=s((()=>N.state.loginType)),S=new IntersectionObserver(((e,a)=>e[0].isIntersecting&&!z.value&&async function(){z.value=!0;try{const{data:e}=await h({uid:L.value.userId,limit:10,offset:q.value});E.value=e.more,$.value=$.value.concat(e.playlist),q.value+=10}catch(e){console.log(e),M.value=!1}finally{z.value=!1}}()));async function B(){await N.dispatch("logout"),$.value=[],q.value=0,E.value=!0,T.replace("/library")}return t((()=>{F.value&&S.observe(F.value)})),u((()=>{S.disconnect()})),n((()=>{F.value&&S.observe(F.value)})),r((()=>{S.disconnect()})),(e,a)=>{const l=c("img");return M.value?(i(),o("div",j,[v(L).userId?(i(),o(p,{key:0},[f("header",C,[m(f("img",I,null,512),[[l,v(L).avatarUrl+"?param=56y56"]]),f("h2",U,y(v(L).nickname)+"的歌单",1),f(k,{onClick:B,name:"logout"})]),f("ul",O,[v(R)===v(g).ACCOUNT&&v(P).length?(i(),o(_,{key:0,class:"mt-3 mx-3",name:v(P)[0].name,"pic-url":v(P)[0].coverImgUrl,id:v(P)[0].id},null,8,["name","pic-url","id"])):d("",!0),(i(!0),o(p,null,x(v(Q),((e,a)=>(i(),o(_,{class:"mt-3 mx-3",key:a,name:e.name,"pic-url":e.coverImgUrl,id:e.id},null,8,["name","pic-url","id"])))),128)),E.value?(i(),o("li",{key:1,class:"my-2 py-2 w-full text-center",ref:F},[f(w)],512)):d("",!0)])],64)):(i(),o("div",A,[f("button",{class:"btn-primary",type:"button",onClick:a[1]||(a[1]=e=>v(T).push(`/login/${v(g).ACCOUNT}`))},"账号登录"),f("button",{class:"btn-primary",type:"button",onClick:a[2]||(a[2]=e=>v(T).push(`/login/${v(g).USERNAME}`))},"昵称登录")]))])):d("",!0)}}});export{N as default};
